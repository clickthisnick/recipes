<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nutrition Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #4CAF50;
      color: white;
      padding: 1rem;
      text-align: center;
    }

    .tabs {
      display: flex;
      background-color: #f1f1f1;
    }

    .tab-button {
      flex: 1;
      padding: 1rem;
      cursor: pointer;
      text-align: center;
      background-color: #ddd;
      border: none;
      outline: none;
    }

    .tab-button.active {
      background-color: #bbb;
      font-weight: bold;
    }

    .tab-content {
      display: none;
      padding: 1rem;
    }

    .tab-content.active {
      display: block;
    }

    select, input, button, textarea {
      display: block;
      margin: 1rem 0;
      padding: 0.5rem;
      width: 100%;
      max-width: 500px;
    }

    .selected-foods {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .food-tag {
      background-color: #e0e0e0;
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      cursor: pointer;
    }

    .food-tag:hover {
      background-color: #ccc;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 800px;
      margin-top: 1rem;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: center;
    }

    @media (max-width: 600px) {
      .tabs {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>Nutrition App</h1>
</header>

<div class="tabs">
  <button class="tab-button active" onclick="showTab('tracker')">Nutrition Tracker</button>
  <button class="tab-button" onclick="showTab('custom')">Add Custom Food</button>
</div>

<div id="tracker" class="tab-content active">
  <h2>Nutrition Tracker</h2>
  <label for="foodSelect">Select foods:</label>
  <select id="foodSelect">
    <option value="">-- Choose a food --</option>
    <option value="apple">Apple</option>
    <option value="banana">Banana</option>
    <option value="chicken_breast">Chicken Breast</option>
    <option value="rice">White Rice</option>
  </select>

  <div class="selected-foods" id="selectedFoods"></div>

  <button onclick="updateNutrition()">Update Nutrition</button>

  <table id="nutritionTable" style="display:none;">
    <thead>
      <tr>
        <th>Nutrient</th>
        <th>Your Intake</th>
        <th>FDA Daily Limit</th>
      </tr>
    </thead>
    <tbody id="nutritionBody"></tbody>
  </table>
</div>

<div id="custom" class="tab-content">
  <h2>Add Custom Food</h2>
  <form id="customFoodForm">
    <input type="text" id="foodName" placeholder="Food Name" required />
    <input type="number" min="0" id="calories" placeholder="Calories" required />
    <input type="number" min="0" id="protein" placeholder="Protein (g)" required />
    <input type="number" min="0" id="carbs" placeholder="Carbohydrates (g)" required />
    <input type="number" min="0" id="fat" placeholder="Fat (g)" required />
    <input type="number" min="0" id="fiber" placeholder="Fiber (g)" required />
    <input type="number" min="0" id="sugar" placeholder="Sugar (g)" required />
    <input type="number" min="0" id="sodium" placeholder="Sodium (mg)" required />
    <button type="submit">Generate JSON</button>
  </form>

  <textarea id="jsonOutput" rows="10" readonly placeholder="JSON will appear here..."></textarea>
  <button onclick="copyJSON()">Copy to Clipboard</button>
  <p><em>Copy this JSON and manually add it to your foods list in your app repo.</em></p>
</div>

<script>
  const nutrients = ['calories', 'protein', 'carbs', 'fat', 'fiber', 'sugar', 'sodium'];

  const fdaLimits = {
    calories: 2000,
    protein: 50,
    carbs: 275,
    fat: 78,
    fiber: 28,
    sugar: 50,
    sodium: 2300
  };

  const foodData = {
    apple: { name: "Apple", calories: 95, protein: 0.5, carbs: 25, fat: 0.3, fiber: 4.4, sugar: 19, sodium: 2 },
    banana: { name: "Banana", calories: 105, protein: 1.3, carbs: 27, fat: 0.3, fiber: 3.1, sugar: 14, sodium: 1 },
    chicken_breast: { name: "Chicken Breast (100g)", calories: 165, protein: 31, carbs: 0, fat: 3.6, fiber: 0, sugar: 0, sodium: 74 },
    rice: { name: "White Rice (1 cup)", calories: 205, protein: 4.3, carbs: 45, fat: 0.4, fiber: 0.6, sugar: 0.1, sodium: 1 }
  };

  let selectedFoods = [];

  function showTab(tabId) {
    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
    document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`).classList.add('active');
    document.getElementById(tabId).classList.add('active');
  }

  document.getElementById('foodSelect').addEventListener('change', function () {
    const food = this.value;
    if (food && !selectedFoods.includes(food)) {
      selectedFoods.push(food);
      renderSelectedFoods();
    }
    this.value = '';
  });

  function renderSelectedFoods() {
    const container = document.getElementById('selectedFoods');
    container.innerHTML = '';
    selectedFoods.forEach(food => {
      const tag = document.createElement('div');
      tag.className = 'food-tag';
      tag.textContent = foodData[food]?.name || food;
      tag.onclick = () => {
        selectedFoods = selectedFoods.filter(f => f !== food);
        renderSelectedFoods();
      };
      container.appendChild(tag);
    });
  }

  function updateNutrition() {
    const totals = {};
    nutrients.forEach(n => totals[n] = 0);

    selectedFoods.forEach(food => {
      const data = foodData[food];
      if (data) {
        nutrients.forEach(n => {
          totals[n] += data[n] || 0;
        });
      }
    });

    const tbody = document.getElementById('nutritionBody');
    tbody.innerHTML = '';

    nutrients.forEach(nutrient => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${nutrient.charAt(0).toUpperCase() + nutrient.slice(1)}</td>
        <td>${totals[nutrient].toFixed(1)}</td>
        <td>${fdaLimits[nutrient]}</td>
      `;
      tbody.appendChild(tr);
    });

    document.getElementById('nutritionTable').style.display = 'table';
  }

  document.getElementById('customFoodForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const food = {
      name: document.getElementById('foodName').value.trim()
    };

    let isValid = food.name.length > 0;

    nutrients.forEach(nutrient => {
      const value = parseFloat(document.getElementById(nutrient).value);
      if (isNaN(value) || value < 0) isValid = false;
      food[nutrient] = value;
    });

    if (!isValid) {
      alert("Please fill out all fields with valid (non-negative) numbers.");
      return;
    }

    const json = JSON.stringify(food, null, 2);
    document.getElementById('jsonOutput').value = json;
  });

  function copyJSON() {
    const text = document.getElementById('jsonOutput').value;
    navigator.clipboard.writeText(text)
      .then(() => alert('JSON copied to clipboard!'))
      .catch(err => alert('Failed to copy JSON: ' + err));
  }
</script>

</body>
</html>
