<meta name="viewport" content="width=device-width, initial-scale=1"><meta charset="utf-8"><style>

    a { 
        color:orange;
        text-decoration:none;
    }

    html {
        background-color: #000000;
    }

    div, h1, h2 {
        background-color: #000000;
        border: none;
        color: #FFFFFF;
    }

    button {
        display: inline-block;
        border-radius: 4px;
        background-color: #f4511e;
        border: none;
        color: #FFFFFF;
        text-align: center;
        font-size: 28px;
        padding: 20px;
        width: 400px;
        transition: all 0.5s;
        cursor: pointer;
        margin: 5px;
    }

    #ingredients {
        
    }

    .completed {
        background-color:green;
        color: white;
        display: none;
    }

    .timer {
        background-color:yellow;
        color: black;
    }

    .panel {
        border-right-style: solid;
        border-bottom-style: solid;
        border-left-style: solid;
        padding: 25px;
        border-width: 1px;
    }
    </style><script>let recipes = {}
let selectedRecipes = []
let selectedRecipeNames = []
let ingredients = {}
let mode = ''
let perishableItems = {}

function playSound(url) {
    const audio = new Audio(url);
    audio.play();
}

function generateHtml() {
    // Reset root incase we are dynamically doing things
    let root = document.getElementById('root')

    if (root) {
        root.innerHTML = ''
    }
}

const parseParams = (querystring) => {

    // parse query string
    const params = new URLSearchParams(querystring);

    const obj = {};

    // iterate over all keys
    for (const key of params.keys()) {
        if (params.getAll(key).length > 1) {
            obj[key] = params.getAll(key);
        } else {
            obj[key] = params.get(key);
        }
    }

    return obj;
}

let queryString = parseParams(window.location.search)

function setRecipe(recipeName, recipe) {
    // Setting the recipe data into the recipe
    if (recipes.hasOwnProperty(recipeName) === false) {
        recipes[recipeName] = []
    }
    recipes[recipeName].push(recipe)
}

function selectMode(id) {
    showElement(id)
    showElement('select')
    mode = id

    hideElement('cookingButton')
    hideElement('shoppingButton')
}

function selectRecipe(recipeName) {
    selectedRecipeNames.push(recipeName)
    selectedRecipes.push(recipes[recipeName])
}

function addStep(istep) {
    let cookingDiv = document.getElementById('cooking')
    if (!cookingDiv) { 
        alert('Cannot find cooking element id')
        return;
    }

    if (istep.showTimer) {
        // <!--Only double quote should be around the onclick-- >
        let divStep = ''
        divStep += "<div class='panel' id='panel-"
        divStep += istep.id + "' "
        divStep += 'onclick="this.classList.toggle('
        divStep += "'timer'"
        divStep += "); loadTimer("
        divStep += istep.time
        divStep += ", "
        divStep += istep.id
        divStep += ");"
        divStep += '"><span id='
        divStep += "'"
        divStep += istep.id
        divStep += "'></span>"
        divStep += istep.text
        divStep += "</div>";
        cookingDiv.innerHTML += divStep
    } else {
        cookingDiv.innerHTML += "";
        // <!--Only double quote should be around the onclick-- >
            
        let divStep = ''
        divStep += "<div class='panel' id='panel-"
        divStep += istep.id + "' "
        divStep += 'onclick="this.classList.toggle('
        divStep += "'timer'"
        divStep += "); document.getElementById('panel-"
        divStep += istep.id
        divStep += "').remove();"
        divStep += '"><span id='
        divStep += "'"
        divStep += istep.id
        divStep += "'></span>"
        divStep += istep.text
        divStep += "</div>";
        cookingDiv.innerHTML += divStep
    }

    if (istep.children && istep.children.length > 0) {
        istep.children.forEach(child => {
            addStep(child);
        })
    }
}

function saveShoppingUrl() {
    // <!--Converts ingredients to a url with query parameters-- >
    //    <!--query parameters = ? mode = shopping & asparagus=["tsb",% 201]-- >
    //        <!--ingredients = { asparagus: { tsb: 1 } } -->
    let queryParamter = document.location.href.split('?')[0] + '?mode=shopping' + '&recipes=' + selectedRecipeNames
    Object.keys(ingredients).forEach(ingredient => {
        let unit = Object.keys(ingredients[ingredient]['units'])[0]
        // < !--url encode - example - replace any spaces with % 20 -- >
        queryParamter += '&' + encodeURI(ingredient) + '=["' + unit + '", %20' + ingredients[ingredient]['units'][unit] + ']'
    })

    document.getElementById('shoppingUrl').innerHTML = queryParamter + "<br>"
}

function generateLinks(linkByPrice, priceKeys) {
    let links = ''

    // sort the prices key so we can list them by price
    priceKeys.sort()

    priceKeys.forEach(priceKey => {
        linkByPrice[priceKey].forEach(value => {
            links += value
        });
    })
    
    return links
}

function applyCreditCardDiscounts(store, pricePerQuantity) {
    // Include any discounts on the price per quantity 
    if (store.startsWith("amazon")) {
        return (pricePerQuantity * .95).toFixed(3)
    } else if (store.startsWith("whole")) {
        return (pricePerQuantity * .95).toFixed(3)
    } else {
        return (pricePerQuantity * .98).toFixed(3)
    }
}
function doneSelectingRecipes() {
    hideElement('select')
    let shoppingDiv = document.getElementById('shopping')

    if (mode === 'shopping') {
        // Get all ingredients across all recipes
        // selectedRecipes is an array of array of recipes
        selectedRecipes.forEach(singleRecipeArray => {
            singleRecipeArray.forEach(singleRecipe => {
                Object.keys(singleRecipe.ingredients).forEach(ingredientKey => {
                    const ingredient = singleRecipe.ingredients[ingredientKey];
                    
                    perishableItems[ingredient.name] = ingredient.perishableLimit

                    // If there are no previous ingredients, add the ingredient
                    if (!ingredients.hasOwnProperty(ingredient.name)) {
                        ingredients[ingredient.name] = ingredient
                    } else {
                        // If the previously known ingredient has the same unit as the ingredient we are adding
                        // Just update the quantity
                        if (ingredients[ingredient.name].unit.name == ingredient.unit.name) {
                            ingredients[ingredient.name].quantity += ingredient.quantity
                        } else {
                            // Otherwise just add the ingredient as the unit
                            ingredients[`${ingredient.name} ${ingredient.unit.name}`] = ingredient
                        }
                    }
                })
            })
        })

        // Show ingredients to the user
        shoppingDiv.innerHTML += '<br>'
        shoppingDiv.innerHTML += selectedRecipeNames
        shoppingDiv.innerHTML += '<br> Perishable Items: '
        shoppingDiv.innerHTML += JSON.stringify(perishableItems)
        shoppingDiv.innerHTML += '<br>'

        Object.keys(ingredients).forEach(ingredientKey => {
            let commonUnit;
            let links = ''

            let linkByPrice = {} // Key is prices, value is array of items
            let priceKeys = [] // Keys of the linkByPrice

            let ingredient = ingredients[ingredientKey]

            // When you click a saved url we don't include the purchaseLinks
            if (ingredient.hasOwnProperty('purchaseLinks')) {
                const stores = Object.keys(ingredient['purchaseLinks']).sort()

                stores.forEach(store => {
                    const storeLinks = ingredient['purchaseLinks'][store];
                    const storeDescriptions = Object.keys(storeLinks);

                    storeDescriptions.forEach(storeDescription => {
                        const items = storeLinks[storeDescription]
                        items.forEach(item => {

                            // Make the first unit found the common unit so when we price compare, all units are the same
                            if (commonUnit === undefined) {
                                commonUnit = item.quantity_unit.name
                            }

                            let pricePerQuantity = item.priceConversionTable[commonUnit]

                            if (item.discount) {
                                Object.keys(item.discount).forEach(discountKey => {
                                    const discountValue = item.discount[discountKey];
                                    const priceMultiple = ((100 - discountValue) * .01).toFixed(2)
                                    
                                    let subscribePricePerQuantity = (pricePerQuantity*priceMultiple).toFixed(3)

                                    subscribePricePerQuantity = applyCreditCardDiscounts(store, subscribePricePerQuantity)

                                    if (!linkByPrice.hasOwnProperty(subscribePricePerQuantity)) {
                                        linkByPrice[subscribePricePerQuantity] = [`</br> ${store}: &nbsp;<a href="${item.link}" target="_blank">${storeDescription} - ${discountKey} ${subscribePricePerQuantity} - ${subscribePricePerQuantity}/${commonUnit}</a>`]
                                        priceKeys.push(subscribePricePerQuantity)
                                    } else {
                                        linkByPrice[subscribePricePerQuantity].push(`</br> ${store}: &nbsp;<a href="${item.link}" target="_blank">${storeDescription} - ${discountKey} ${subscribePricePerQuantity} - ${subscribePricePerQuantity}/${commonUnit}</a>`)
                                    }
                                })
                            }

                            pricePerQuantity = applyCreditCardDiscounts(store, pricePerQuantity)

                            if (!linkByPrice.hasOwnProperty(pricePerQuantity)) {
                                linkByPrice[pricePerQuantity] = [`</br> ${store}: &nbsp;<a href="${item.link}" target="_blank">${storeDescription} - ${item.price} - ${pricePerQuantity}/${commonUnit}</a>`]
                                priceKeys.push(pricePerQuantity)
                            } else {
                                linkByPrice[pricePerQuantity].push(`</br> ${store}: &nbsp;<a href="${item.link}" target="_blank">${storeDescription} - ${item.price} - ${pricePerQuantity}/${commonUnit}</a>`)
                            }



                        })
                    })

                    links = generateLinks(linkByPrice, priceKeys)
                })
            }

            shoppingDiv.innerHTML += '<div id="shopping-' + ingredient.name + '" class="panel" style="">' + '<span onclick="this.classList.toggle(' + "'completed'" + "); document.getElementById('shopping-" + ingredient.name  + "').remove(); delete ingredients['" + ingredient.name  + "'" + '];" >' + ingredient.name  + ' ' + ingredient.quantity + ' ' + ingredient.unit.name + '</span>' + links + '</div>'
        })
    } else {
        selectedRecipes.forEach(recipes => {
            recipes.forEach(recipe => {
                recipe.steps.forEach(istep => {
                    addStep(istep)
                })
            })
        })
    }
}

function showElement(id) {
    document.getElementById(id).style.display = "inline"
}

function showElementsByClassName(className) {
    var elements = document.getElementsByClassName(className);

    for (let i = 0; i < elements.length; i++) {
        let element = elements[i];
        element.style.display = "inline";    
    }    
}

function hideElement(id) {
    document.getElementById(id).style.display = "none"
}









// This is where my new recipe app ends

function setIntervalX(callback, delay, repetitions) {
    var x = 0;
    var intervalID = window.setInterval(function () {

        callback();

        if (++x === repetitions) {
            window.clearInterval(intervalID);
        }
    }, delay);
}

function showAllIngredients() {
    let ingredientDiv = document.getElementById('ingredients');

    ingredientDiv.style.display = 'inline'
}

function showAllSteps() {
    let elements = document.getElementsByClassName('panel');

    for (let i = 0; i < elements.length; i++) {
        elements[i].style.display = 'block';
    }
}

function setStepVisibility(idxToShow, idxToHide) {
    document.getElementById("panel-" + idxToHide).style.display = 'none';
    document.getElementById("panel-" + idxToShow).style.display = 'block';
}

var timerClicks = {};

function startTimer(duration, stepId, stepIdxToShow, async) {
    let timerPanelId = "panel-" + stepId
    let timerElement = document.getElementById(timerPanelId);
    if (timerClicks.hasOwnProperty(timerPanelId)) {
        timerClicks[timerPanelId] += 1
    } else {
        timerClicks[timerPanelId] = 0
    }

    if (timerElement && timerElement.getAttribute('class')) {
        let timerClass = timerElement.getAttribute('class');
        if (timerClass && timerClass.includes('timer')) {
            // <!--If you click block 2 times after timer started, then you can skip-- >
            if (timerClicks[timerPanelId] >= 2) {
                //<!--Only show next element if not an async timer-- >
                // if (async == false) {
                //     document.getElementById("panel-" + stepIdxToShow).style.display = 'block';
                // }
                document.getElementById(timerPanelId).style.display = 'none';
            }
        }
    }

    //     return
    // } else {
    //     document.getElementById(timerPanelId).classList.toggle('timer')
    // }

    // if (async) {
    //     document.getElementById("panel-" + stepIdxToShow).style.display = 'block';
    // }

    let originalTimerHtml = timerElement.innerHTML;
    let intervalID = window.setInterval(function () {
        let minutes = parseInt(duration / 60, 10)
        let seconds = parseInt(duration % 60, 10);

        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;

        timerElement.innerHTML = minutes + ":" + seconds + " " + originalTimerHtml;

        if (--duration < 0) {
            window.clearInterval(intervalID);
            timerElement.classList.toggle('timer');
            timerElement.classList.toggle('completed');
            if (async == false) {
                document.getElementById(timerPanelId).style.display = 'none';
                document.getElementById("panel-" + stepIdxToShow).style.display = 'block';
            }

            if (document.getElementById(timerPanelId).style.display != 'none') {
                playSound("../src/sounds/pager-beep.mp3")
            }
        }
    }, 1000);
}

function loadTimer(seconds, stepId, stepIdxToShow, async) {
    startTimer(seconds, stepId, stepIdxToShow, async);
}

var shownId = '';

function getCheckedOptions() {
   var id = '';
   var htmlCollection = document.getElementById('options').getElementsByTagName('button')

   for (const item of htmlCollection) {
     if (item.classList[0] == 'completed') {
         id += item.innerHTML
     }
   }

   return id
}

// Used to hide/show recipes
function showRecipe() {
    var id = getCheckedOptions()

    // Show
    if (document.getElementById(id)) {
        document.getElementById(id).style.display = 'block';
    }

    if (document.getElementById(shownId)) {
        // Hide previously shown
        document.getElementById(shownId).style.display = 'none';
    }

    shownId = id;
}
</script><button id="shoppingButton" onclick="selectMode('shopping')">Shopping Mode</button><button id="cookingButton" onclick="selectMode('cooking')">Cooking Mode</button><br><div id="shopping" style="display: none;">Shopping List<button onclick="saveShoppingUrl()">Save Shopping Url</button><br><span id="shoppingUrl"></span></div><br><div id="cooking" style="display: none;">Cooking List</div><br><div id="select" style="display: none;">Select Recipes<br><button onclick="doneSelectingRecipes()">Done Selecting</button><br><script>setRecipe('DateBalls', {"steps":[{"id":1,"time":300,"text":"Soak 20 dates in a bowl for 5 m","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timesUp","showTimer":true},{"id":2,"time":0,"text":"","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timerIsUp","showTimer":false},{"id":3,"time":0,"text":"Dice 20 unit Pitted Dates","ingredients":[{"name":"Pitted Dates","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":20,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"unit","isEquipment":false},"purchaseLinks":{"whole foods":{"365 by Whole Foods Market, Dried Fruit, Pitted Dates":[{"price":3.99,"quantity":8,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Dates-Pitted/dp/B074VDMNH7/ref=sr_1_5_0o_wf","organic":false,"priceConversionTable":{"ounce":"0.499","cup":"0.062","pound":"7.984"}}]},"amazon":{"ORGANIC Pitted Dates (Deglet Nour) - Sunny Fruit 40oz Bulk Bag (2.5 lbs)":[{"price":16.59,"quantity":2.5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/ORGANIC-Pitted-Dates-Deglet-Nour/dp/B0872L82ZK/ref=sr_1_10","organic":true,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"6.636","cup":"0.052","ounce":"0.415"}}],"5 Pounds Of Dates Pitted (80oz) No Added Sugar, Non GMO, Kosher Certified,Healthy Snack for Kids & Adults":[{"price":24.89,"quantity":5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/5-Pounds-Dates-Pitted-5lb/dp/B0727V394G/ref=sr_1_9","organic":false,"discount":{"Subscribe 5 Products":10,"Subscribe":5},"priceConversionTable":{"pound":"4.978","cup":"0.039","ounce":"0.311"}}],"Mariani Pitted Dates - 40oz (Pack of 1) – Exceptional Taste and Soft Texture, No Sugar Added, Good Source of Dietary Fiber, Gluten Free, Vegan, Fat Free, Cholesterol Free, NonGMO, Resealable Bag":[{"price":14.08,"quantity":2.5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Mariani-Pitted-Dates-Natural-40-Ounce/dp/B0027YZBJC/ref=sxin_9","organic":false,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"5.632","cup":"0.044","ounce":"0.352"}}]}}}],"equipment":["cutting board","knife"],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":4,"time":0,"text":"Add the following to a KitchenAid Mixing Bowl","ingredients":[],"equipment":[],"children":[{"id":5,"time":10,"text":"•  pitted dates","ingredients":[{"name":"pitted dates","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":0,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"none","isEquipment":false},"purchaseLinks":{"whole foods":{"365 by Whole Foods Market, Dried Fruit, Pitted Dates":[{"price":3.99,"quantity":8,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Dates-Pitted/dp/B074VDMNH7/ref=sr_1_5_0o_wf","organic":false}]},"amazon":{"ORGANIC Pitted Dates (Deglet Nour) - Sunny Fruit 40oz Bulk Bag (2.5 lbs)":[{"price":16.59,"quantity":2.5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/ORGANIC-Pitted-Dates-Deglet-Nour/dp/B0872L82ZK/ref=sr_1_10","organic":true,"discount":{"Subscribe 5 Products":5}}],"5 Pounds Of Dates Pitted (80oz) No Added Sugar, Non GMO, Kosher Certified,Healthy Snack for Kids & Adults":[{"price":24.89,"quantity":5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/5-Pounds-Dates-Pitted-5lb/dp/B0727V394G/ref=sr_1_9","organic":false,"discount":{"Subscribe 5 Products":10,"Subscribe":5}}],"Mariani Pitted Dates - 40oz (Pack of 1) – Exceptional Taste and Soft Texture, No Sugar Added, Good Source of Dietary Fiber, Gluten Free, Vegan, Fat Free, Cholesterol Free, NonGMO, Resealable Bag":[{"price":14.08,"quantity":2.5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Mariani-Pitted-Dates-Natural-40-Ounce/dp/B0027YZBJC/ref=sxin_9","organic":false,"discount":{"Subscribe 5 Products":5}}]}}}],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":6,"time":10,"text":"• ½ cup unsweetened cacao powder","ingredients":[{"name":"unsweetened cacao powder","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":0.5,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"cup","isEquipment":true},"purchaseLinks":{"amazon":{"Anthony's Organic Raw Cocoa Powder, Cacao Powder 5lb":[{"price":29.99,"quantity":5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Organic-Anthonys-Verified-Gluten-Free-Non-GMO/dp/B00F7SU63G","organic":true,"priceConversionTable":{"pound":"5.998","cup":"0.047","ounce":"0.375"}}],"Anthony's Organic Raw Cocoa Powder, Cacao Powder 2lb":[{"price":14.85,"quantity":2,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Organic-Anthonys-Verified-Gluten-Free-Non-GMO/dp/B0833QH1N4?th=1","organic":true,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"7.425","cup":"0.058","ounce":"0.464"}}],"BetterBody Foods Organic Cacao Powder, Non-GMO, Gluten-Free Superfood":[{"price":8.49,"quantity":1,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/LIVfit-Superfood-Guilt-Free-Substitute-BetterBody/dp/B01IPZUZW4","organic":true,"discount":{"Subscribe 5 Products":15,"Subscribe":5},"priceConversionTable":{"pound":"8.490","cup":"0.066","ounce":"0.531"}}]}}}],"equipment":["cup"],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":7,"time":10,"text":"• 1 cup collagen powder","ingredients":[{"name":"collagen powder","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":1,"wash":false,"isTakoutUnitable":false,"isMeatProduct":true,"nutrition":{},"unit":{"name":"cup","isEquipment":true},"purchaseLinks":{"amazon":{"Anthony's Collagen Peptide Powder, 1 lb, Pure Hydrolyzed, Gluten Free, Keto and Paleo Friendly, Grass Fed":[{"price":17.99,"quantity":1,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/gp/product/B071S8D69C/ref=ppx_yo_dt_b_asin_title_o00_s00","organic":false,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"17.990","cup":"0.141","ounce":"1.124"}}]}}}],"equipment":["cup"],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":8,"time":10,"text":"• 1 cup water","ingredients":[{"name":"water","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":1,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"cup","isEquipment":true},"purchaseLinks":{}}],"equipment":["cup"],"children":[],"disappearWhen":"clicked","showTimer":false}],"disappearWhen":"childrenGone","showTimer":false},{"id":22,"time":0,"text":"Clean and put away knife","ingredients":[],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":21,"time":0,"text":"Clean and put away cutting board","ingredients":[],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":9,"time":60,"text":"Mix with whisk attachment for 1 minutes for 1 m","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timesUp","showTimer":true},{"id":20,"time":0,"text":"Clean and put away cup","ingredients":[],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":10,"time":0,"text":"","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timerIsUp","showTimer":false},{"id":11,"time":0,"text":"Add the following to the KitchenAid Mixing Bowl","ingredients":[],"equipment":[],"children":[{"id":12,"time":10,"text":"• 16 ounces peanut butter","ingredients":[{"name":"peanut butter","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":16,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"ounce","isEquipment":false},"purchaseLinks":{"whole foods":{"365 by Whole Foods Market, Organic Peanut Butter, Creamy":[{"price":4.19,"quantity":16,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Organic-Unsweetened/dp/B074H61LYV/ref=sr_1_9_0o_wf","organic":true,"priceConversionTable":{"ounce":"0.262","cup":"0.033","pound":"4.192"}}],"365 by Whole Foods Market, Peanut Butter, Creamy":[{"price":2.49,"quantity":16,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Peanut-Butter/dp/B074H57SPT/ref=sr_1_7_0o_wf","organic":false,"priceConversionTable":{"ounce":"0.156","cup":"0.019","pound":"2.496"}}],"365 by Whole Foods Market, Peanut Butter, Crunchy":[{"price":4.99,"quantity":36,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/Everyday-Value-Peanut-Butter-Crunchy/dp/B074Y2V88X/ref=sr_1_16_0o_wf","organic":false,"priceConversionTable":{"ounce":"0.139","cup":"0.017","pound":"2.224"}}]},"amazon fresh":{"Amazon Brand - Happy Belly Creamy Peanut Butter":[{"price":3.99,"quantity":40,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/Amazon-Brand-Creamy-Peanut-Butter/dp/B07KWGSCW2","organic":false,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"ounce":"0.100","cup":"0.013","pound":"1.600"}}]}},"perishableLimit":7}],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false}],"disappearWhen":"childrenGone","showTimer":false},{"id":13,"time":60,"text":"Mix with whisk attachment for 1 minutes for 1 m","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timesUp","showTimer":true},{"id":14,"time":0,"text":"","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timerIsUp","showTimer":false},{"id":15,"time":0,"text":"Take a tbsp of batter and put on cutting board, repeat until no more batter. Makes around 60","ingredients":[],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":16,"time":7200,"text":"Put on plastic cutting board and put into freezer for 120 m","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timesUp","showTimer":true},{"id":17,"time":0,"text":"","ingredients":[],"equipment":[""],"children":[],"disappearWhen":"timerIsUp","showTimer":false},{"id":19,"time":0,"text":"Clean and put away ","ingredients":[],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false},{"id":18,"time":0,"text":"Transfer pieces into plastic container and keep in freezer","ingredients":[],"equipment":[],"children":[],"disappearWhen":"clicked","showTimer":false}],"ingredients":{"Pitted Dates":{"name":"Pitted Dates","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":20,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"unit","isEquipment":false},"purchaseLinks":{"whole foods":{"365 by Whole Foods Market, Dried Fruit, Pitted Dates":[{"price":3.99,"quantity":8,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Dates-Pitted/dp/B074VDMNH7/ref=sr_1_5_0o_wf","organic":false,"priceConversionTable":{"ounce":"0.499","cup":"0.062","pound":"7.984"}}]},"amazon":{"ORGANIC Pitted Dates (Deglet Nour) - Sunny Fruit 40oz Bulk Bag (2.5 lbs)":[{"price":16.59,"quantity":2.5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/ORGANIC-Pitted-Dates-Deglet-Nour/dp/B0872L82ZK/ref=sr_1_10","organic":true,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"6.636","cup":"0.052","ounce":"0.415"}}],"5 Pounds Of Dates Pitted (80oz) No Added Sugar, Non GMO, Kosher Certified,Healthy Snack for Kids & Adults":[{"price":24.89,"quantity":5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/5-Pounds-Dates-Pitted-5lb/dp/B0727V394G/ref=sr_1_9","organic":false,"discount":{"Subscribe 5 Products":10,"Subscribe":5},"priceConversionTable":{"pound":"4.978","cup":"0.039","ounce":"0.311"}}],"Mariani Pitted Dates - 40oz (Pack of 1) – Exceptional Taste and Soft Texture, No Sugar Added, Good Source of Dietary Fiber, Gluten Free, Vegan, Fat Free, Cholesterol Free, NonGMO, Resealable Bag":[{"price":14.08,"quantity":2.5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Mariani-Pitted-Dates-Natural-40-Ounce/dp/B0027YZBJC/ref=sxin_9","organic":false,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"5.632","cup":"0.044","ounce":"0.352"}}]}}},"unsweetened cacao powder":{"name":"unsweetened cacao powder","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":0.5,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"cup","isEquipment":true},"purchaseLinks":{"amazon":{"Anthony's Organic Raw Cocoa Powder, Cacao Powder 5lb":[{"price":29.99,"quantity":5,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Organic-Anthonys-Verified-Gluten-Free-Non-GMO/dp/B00F7SU63G","organic":true,"priceConversionTable":{"pound":"5.998","cup":"0.047","ounce":"0.375"}}],"Anthony's Organic Raw Cocoa Powder, Cacao Powder 2lb":[{"price":14.85,"quantity":2,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/Organic-Anthonys-Verified-Gluten-Free-Non-GMO/dp/B0833QH1N4?th=1","organic":true,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"7.425","cup":"0.058","ounce":"0.464"}}],"BetterBody Foods Organic Cacao Powder, Non-GMO, Gluten-Free Superfood":[{"price":8.49,"quantity":1,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/LIVfit-Superfood-Guilt-Free-Substitute-BetterBody/dp/B01IPZUZW4","organic":true,"discount":{"Subscribe 5 Products":15,"Subscribe":5},"priceConversionTable":{"pound":"8.490","cup":"0.066","ounce":"0.531"}}]}}},"collagen powder":{"name":"collagen powder","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":1,"wash":false,"isTakoutUnitable":false,"isMeatProduct":true,"nutrition":{},"unit":{"name":"cup","isEquipment":true},"purchaseLinks":{"amazon":{"Anthony's Collagen Peptide Powder, 1 lb, Pure Hydrolyzed, Gluten Free, Keto and Paleo Friendly, Grass Fed":[{"price":17.99,"quantity":1,"quantity_unit":{"name":"pound","isEquipment":false},"link":"https://www.amazon.com/gp/product/B071S8D69C/ref=ppx_yo_dt_b_asin_title_o00_s00","organic":false,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"pound":"17.990","cup":"0.141","ounce":"1.124"}}]}}},"water":{"name":"water","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":1,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"cup","isEquipment":true},"purchaseLinks":{}},"peanut butter":{"name":"peanut butter","putAwayTime":10,"takeOutTime":10,"cleanSteps":"","quantity":16,"wash":false,"isTakoutUnitable":false,"isMeatProduct":false,"nutrition":{},"unit":{"name":"ounce","isEquipment":false},"purchaseLinks":{"whole foods":{"365 by Whole Foods Market, Organic Peanut Butter, Creamy":[{"price":4.19,"quantity":16,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Organic-Unsweetened/dp/B074H61LYV/ref=sr_1_9_0o_wf","organic":true,"priceConversionTable":{"ounce":"0.262","cup":"0.033","pound":"4.192"}}],"365 by Whole Foods Market, Peanut Butter, Creamy":[{"price":2.49,"quantity":16,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/365-Everyday-Value-Peanut-Butter/dp/B074H57SPT/ref=sr_1_7_0o_wf","organic":false,"priceConversionTable":{"ounce":"0.156","cup":"0.019","pound":"2.496"}}],"365 by Whole Foods Market, Peanut Butter, Crunchy":[{"price":4.99,"quantity":36,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/Everyday-Value-Peanut-Butter-Crunchy/dp/B074Y2V88X/ref=sr_1_16_0o_wf","organic":false,"priceConversionTable":{"ounce":"0.139","cup":"0.017","pound":"2.224"}}]},"amazon fresh":{"Amazon Brand - Happy Belly Creamy Peanut Butter":[{"price":3.99,"quantity":40,"quantity_unit":{"name":"ounce","isEquipment":false},"link":"https://www.amazon.com/Amazon-Brand-Creamy-Peanut-Butter/dp/B07KWGSCW2","organic":false,"discount":{"Subscribe 5 Products":5},"priceConversionTable":{"ounce":"0.100","cup":"0.013","pound":"1.600"}}]}},"perishableLimit":7}},"vegan":true,"timeEstimateMilliseconds":0,"estimates":{"calories":0,"sodium":0,"sugar":0,"fiber":0,"protein":0,"total_cost":0},"estimatesMissing":{"calories":[],"sodium":[],"sugar":[],"fiber":[],"protein":[],"total_cost":[]},"recipeHtml":"","autoShow":false})</script><button onclick="selectRecipe('DateBalls')">DateBalls</button><div id="root"></div id="root"></div><br>
    <script>
    if (queryString.hasOwnProperty('mode')) {
        let mode = queryString['mode']
        delete queryString['mode'];

        if (queryString.hasOwnProperty('recipes')) {
          let recipes = queryString['recipes']
          delete queryString['recipes'];
          document.getElementById('shopping').innerHTML += recipes
        }

        selectMode(mode)

        if (mode == 'shopping') {
          Object.keys(queryString).forEach(key => {
            // [unit, quantity]
            let item = JSON.parse(queryString[key]);

            ingredients[key] = {}

            // Put the units and values in the correct spot
            // The assumption here is if you are clicking the link you are going somewhere to buy
            // Whereas when you originally generate the link you get the online purchase options
            ingredients[key]['units'] = {}
            ingredients[key]['units'][item[0]] = item[1]
            
          })
        }
        doneSelectingRecipes()
    }
    </script>